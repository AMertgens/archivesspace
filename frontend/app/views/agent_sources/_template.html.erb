<% r = @required.values %>

<% define_template "agent_sources", jsonmodel_definition(:agent_sources) do |form| %>
  <div class="subrecord-form-fields">
    <div class="agent-record-control-container">
      <%= form.label_and_textfield "source_entry",  
      {:field_opts => {:size => 30, :class => "form-control"},
      :required => is_required_by_admin?(r, "agent_sources", "source_entry") }%>

      <%= form.label_and_textfield "descriptive_note",  
        {:field_opts => {:size => 30, :class => "form-control"},
        :required => is_required_by_admin?(r, "agent_sources", "descriptive_note") }%>

      <%= form.label_and_textfield "file_uri",  
        {:field_opts => {:size => 30, :class => "form-control"}, 
        :required => is_required_by_admin?(r, "agent_sources", "file_uri")}%>

      <%= form.label_and_select "file_version_xlink_actuate_attribute", 
        [""] + form.possible_options_for("file_version_xlink_actuate_attribute", false),
        :required => is_required_by_admin?(r, "agent_sources", "file_version_xlink_actuate_attribute") %>

      <%= form.label_and_select "file_version_xlink_show_attribute", 
        [""] + form.possible_options_for("file_version_xlink_show_attribute", false),
        :required => is_required_by_admin?(r, "agent_sources", "file_version_xlink_show_attribute") %>

      <%= form.label_and_textfield "xlink_title_attribute",  
        {:field_opts => {:size => 30, :class => "form-control"},
        :required => is_required_by_admin?(r, "agent_sources", "xlink_title_attribute") }%>

      <%= form.label_and_textfield "xlink_role_attribute",  
        {:field_opts => {:size => 30, :class => "form-control"},
        :required => is_required_by_admin?(r, "agent_sources", "xlink_role_attribute") }%>

      <%= form.label_and_date "last_verified_date",
        :required => is_required_by_admin?(r, "agent_sources", "last_verified_date") %>
    </div>
  </div>
<% end %>

<% define_template "agent_source_required", jsonmodel_definition(:agent_sources) do |form| %>
  <% field_names = ["source_entry", "descriptive_note", "file_uri", "file_version_xlink_actuate_attribute", "file_version_xlink_show_attribute", "xlink_title_attribute", "xlink_role_attribute", "last_verified_date"] %>
  <% field_names.each do |field_name| %>
    <% if form.required?(field_name) %>
      <%= form.label_and_readonly field_name %>
    <% else %>
      <%= form.label_and_req_boolean field_name %>
    <% end %>
  <% end %>
<% end %>


<% define_template "agent_source_merge_target", jsonmodel_definition(:agent_sources) do |form| %>
  <% field_names = ["source_entry", "descriptive_note", "file_uri", "file_version_xlink_actuate_attribute", "file_version_xlink_show_attribute", "xlink_title_attribute", "xlink_role_attribute", "last_verified_date"] %>
  <% field_names.each do |field_name| %>
    <%= form.label_and_readonly field_name %>
  <% end %>
<% end %>

<% define_template "agent_source_merge_victim", jsonmodel_definition(:agent_sources) do |form| %>
  <h4 class="subrecord-form-heading">
    <%= I18n.t("agent_sources._plural") %>
    <label class="append"><%= form.merge_checkbox('append') %><small><%= I18n.t("actions.merge_add") %></small></label>
  </h4>

  <%= form.label_and_merge_select "source_entry" %>
  <%= form.label_and_merge_select "descriptive_note" %>
  <%= form.label_and_merge_select "file_uri" %>
  <%= form.label_and_merge_select "file_version_xlink_actuate_attribute" %>
  <%= form.label_and_merge_select "file_version_xlink_show_attribute" %>
  <%= form.label_and_merge_select "xlink_title_attribute" %>
  <%= form.label_and_merge_select "xlink_role_attribute" %>
  <%= form.label_and_merge_select "last_verified_date" %>

<% end %>
