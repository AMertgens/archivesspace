<%= setup_context(:title => I18n.t("accession._plural")) %>

<%
   @show_multiselect_column = user_can?("delete_archival_record")
   @title_column_header = user_prefs["accession_browse_label_title"]
   id_label = user_prefs["accession_browse_label_identifier"] || I18n.t("accession.identifier")

   (1..5).to_a.each do |n|
     prop = user_prefs["accession_browse_column_#{n}"]
     if prop
       add_column(I18n.t("accession.#{prop}"),
                  proc { |record|
                    v = record[prop] || ASUtils.json_parse(record['json'])[prop]
                    I18n.t("enumerations.accession_#{prop}.#{v}", :default => v.to_s)
                  }, :sortable => true, :sort_by => prop)
     end
   end
%>

<div class="row-fluid">
  <div class="span3">
      <%= render_aspace_partial :partial => "search/filter" %>
  </div>
  <div class="span9">
    <% if user_can?('update_archival_record') %>
      <div class="row-fluid">
        <div class="span12">
          <div class="record-toolbar">
            <div class="pull-right">
              <%= link_to I18n.t("accession._frontend.action.create"), {:controller => :accessions, :action => :new}, :class => "btn btn-small" %>
              <% if user_can?("delete_archival_record") %>
                <%= button_delete_multiple_action(:archival_records) %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
    <div class="record-pane">
      <%= link_to_help :topic => "search" %>

      <h2><%= I18n.t("accession._plural") %></h2>

      <%= render_aspace_partial :partial => "shared/flash_messages" %>

      <%= render_aspace_partial :partial => "search/listing" %>
    </div>
  </div>
</div>
