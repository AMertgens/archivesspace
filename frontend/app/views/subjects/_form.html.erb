<%= render "shared/form_messages", :object => @subject %>
<fieldset>
   <%= f.hidden_field :vocabulary, :value => session[:vocabulary]['uri'] %>

   <section id="terms">
     <h3>Terms</h3>
     <div class="row-fluid">
        <div class="span5">Term</div>
        <div class="span5">Type</div>
        <div class="span2"></div>
     </div>
     <div class="terms-container" data-terms="<%= @subject.terms.to_json %>"></div>

     <hr/>

     <div class="well">
        <div class="subject-preview"><em>Subject Preview</em></div>
     </div>
     
   </section>

   <section id="external_documents">
     <h3>
       External Documents
       <input type="button" class="btn btn-small pull-right" value="Add External Document"/>
     </h3>
     <div id="external_documents_container">
       <% if @subject.external_documents.blank? %>
         <p class="alert alert-info">Click 'Add External Document' to add an external document record.</p>
       <% else %>
         <% @subject.external_documents.each_with_index do | external_document, index | %>
           <% f.with_jsonmodel("external_documents[]", external_document, :external_document) do %>
             <%= render :partial => "external_documents/form", :locals => {:f => f, :index => index} %>
           <% end %>
         <% end %>
       <% end %>
     </div>
   </section>

</fieldset>


<%= render :partial => "external_documents/template", :locals => {:f => f} %>

<div id="subjects_term_template"><!--
   <div class="row-fluid inputs-fill-it-up">
      <div class="span5"><input type="text" name="subject[terms][][term]" data-source="<%= session['vocabulary']['terms'].to_json %>" autocomplete="off" /></div>
      <div class="span5">
         <select name="subject[terms][][term_type]">
            <% JSONModel(:term).schema["properties"]["term_type"]["enum"].each do |option| %>
               <option value="<%= option %>"><%= option %></option>
            <% end %>
         </select>
      </div>
      <div class="span2">
         <div class="btn-group">
            <button type="button" class="btn btn-small add-term-btn">Add</button>
            <button type="button" class="btn btn-small remove-term-btn"><span class="icon-remove-sign"></span></button>
         </div>
         <input type="hidden" name="subject[terms][][vocabulary]" value="<%= session[:vocabulary]['uri'] %>"/>
      </div>
   </div>
--></div>

<div id="subjects_preview_template"><!--
  {for t in terms}
   <span class="term">${t.term}</span>
   {if t_index < terms.length-1}<span class="term-separator">--</span>{/if}
  {/for}
--></div>