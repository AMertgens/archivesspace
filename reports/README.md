REPORTS IN ASPACE
-------------


ArchivesSpace now supports Jasper Reports for generating reports, in addition to the standard reports module. This includes both reports using a JSON datasource from the API or a direct database access using the JDBC connection.

Most users will probably want to use the JDBC report. However, the JSON report is a good option if 1) you don't have direct access to your database to author the report or 2) have a rather simple report.

To add a Jasper Report to ArchivesSpace, you'll first need to make the Japer jrxml files using iReport or Jasper Studio.
NOTE:  Some jrxml files generated by iReport and Jasper Studio put language="groovy" in the XML root. ASpace doesn't use Groovy, so remove this declaration from the XML, otherwise ASpace will not launch correctly.

Adding these to ArchivesSpace is rather straight-forward:

Create a directory in ASPACE_BASE/reports with the name of your report. This should follow a camelcase format ( e.g. "CamelCaseFormat", no spaces/underscores with the first letter of each word capitalized ) and end with word "Report" ( e.g. "MyLocationReport"  )

Put your reports jrxml files here. Make the main report have the same name as your directory ( e.g. MyLocationReport.jrxml ). Subreports can be named whatever you like, as their filesnames are referred in the primary report xml file.

Your report will also need some plug-in code to have it work in the application. In plugins/local/backend/model, create a ruby file with the same name as you report "MyLocationReport.rb").

The contents of this file depend on if you want to make a JDBC report or a JSON based report.

For JDBC report, this file will look like this:

```ruby
class MyLocationReport < JDBCReport
	register_report({
         :uri_suffix => "my_location",
         :description => "My cool locations",
	})
end
```

There's not much, since the SQL query that drives the report is included in the jrxml report.

For JSON reports, the file will look like this:

```ruby
class LocationsReport < JSONReport

	register_report({
		:uri_suffix => "my_location",
		:description => "My cool locations",
	})


	def query
          locations = db[:location].select(:building, :title, :floor, :room, :area, :barcode, :classification, :id ).all
          results = { :locations => locations }
          return results
	end

end
```

Itâ€™s same as the JDBC Report, except in JSON reports we add a query that will pull the JSON for us from the backend. This uses the Sequel ORM, which has [documentation on querying]( http://sequel.jeremyevans.net/rdoc/files/doc/querying_rdoc.html ). 


4) Restart the application. You should now see your reports in the Staff UI's report interface.


Questions? Please contact us and let us know. 



Report Assets
-------------

## Using a custom font for PDF reports

ArchivesSpace uses the public domain font `Deja Vu` when rendering PDF reports.  While this font offers a good
coverage of Unicode characters, you may wish to use your own licenced font for a greater coverage.

To configure your own font:

1. Under your `archivesspace` directory add your `ttf` font to the `reports/static/fonts` directory

2. In the `config/config.rb`, modify the following configuration settings to refer to your new font:

        AppConfig[:report_pdf_font_paths] = proc { ["#{AppConfig[:backend_url]}/reports/static/fonts/myfont.ttf"] }
        AppConfig[:report_pdf_font_family] = "My Font"

3. Restart your application for the new configuration settings to apply.


